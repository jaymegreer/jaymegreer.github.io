<!-- <?php
session_start();

function calculatePenaltyScore($word1, $word2) {
    $word1 = strtolower($word1);
    $word2 = strtolower($word2);

    $exactMatchPenalty = 0;
    $consonantConsonantPenalty = 1;
    $vowelVowelPenalty = 1;
    $vowelConsonantPenalty = 3;
    $gapPenalty = 2;

    $matrix = array_fill(0, strlen($word1) + 1, array_fill(0, strlen($word2) + 1, 0));

    for ($i = 1; $i <= strlen($word1); $i++) {
        for ($j = 1; $j <= strlen($word2); $j++) {
            $match = ($word1[$i - 1] == $word2[$j - 1]) ? $matrix[$i - 1][$j - 1] + $exactMatchPenalty : $matrix[$i - 1][$j - 1] + $consonantConsonantPenalty;

            $delete = $matrix[$i - 1][$j] + $gapPenalty;

            $insert = $matrix[$i][$j - 1] + $gapPenalty;

            if (isVowel($word1[$i - 1]) && isVowel($word2[$j - 1])) {
                $replace = $match;
            } 
            elseif (!isVowel($word1[$i - 1]) && !isVowel($word2[$j - 1])) {
                $replace = $match;
            } 
            else {
                $replace = $match + $vowelConsonantPenalty;
            }
            $matrix[$i][$j] = min($delete, $insert, $replace);
        }
    }
    return $matrix[strlen($word1)][strlen($word2)];
}


function isVowel($char) {
    return in_array(strtolower($char), ['a', 'e', 'i', 'o', 'u']);
}


function getSuggestions($inputWord, $dictionary) {
    $scores = array();

    while (!feof($dictionary)) {
        $word = trim(fgets($dictionary));
        $word = strtolower($word);
        $score = calculatePenaltyScore($inputWord, $word);
        $scores[$word] = $score;
    }

    fclose($dictionary);

    asort($scores);

    return array_slice($scores, 0, 10);
}


if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $inputWord = strtolower($_POST['word']);

    $_SESSION['inputWord'] = $inputWord;

    $dictionary = fopen("dictionary.txt", "r") or die("Unable to open file!");

    $suggestions = getSuggestions($inputWord, $dictionary);
} 
else {
    $inputWord = isset($_SESSION['inputWord']) ? $_SESSION['inputWord'] : '';

    $dictionary = fopen("dictionary.txt", "r") or die("Unable to open file!");

    $suggestions = getSuggestions($inputWord, $dictionary);
}
?> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spell Checker</title>
</head>

<body>
    <h1><b>Spell Checker</b></h1>

    <form id="spellCheckForm">
        <label for="word">Enter Word:</label><br>
        <input required type="text" id="word" name="word"><br><br>
        <input type="submit" value="Check" onclick="checkSpell()">
    </form>

    <h2>Suggestions:</h2>
    
    <script>
        function calculatePenaltyScore(word1, word2) {
            word1 = word1.toLowerCase();
            word2 = word2.toLowerCase();

            var exactMatchPenalty = 0;
            var consonantConsonantPenalty = 1;
            var vowelVowelPenalty = 1;
            var vowelConsonantPenalty = 3;
            var gapPenalty = 2;

            var matrix = Array.from({ length: word1.length + 1 }, () => Array(word2.length + 1).fill(0));

            for ($i = 1; $i <= word1.length; $i++) {
                for ($j = 1; $j <= word2.length; $j++) {
                    var match = (word1[i - 1] === word2[j - 1]) ? matrix[i - 1][j - 1] + exactMatchPenalty : matrix[i - 1][j - 1] + consonantConsonantPenalty;
                    var deleteCost = matrix[i - 1][j] + gapPenalty;
                    var insertCost = matrix[i][j - 1] + gapPenalty;

                    var replace;
                    if (isVowel(word1[i - 1]) && isVowel(word2[j - 1])) {
                        replace = match;
                    } 
                    else if (!isVowel(word1[i - 1]) && !isVowel(word2[j - 1])) {
                        replace = match;
                    } 
                    else {
                        replace = match + vowelConsonantPenalty;
                    }

                    matrix[i][j] = Math.min(deleteCost, insertCost, replace);
                }
            }
            return matrix[word1.length][word2.length];
        }

        function isVowel(char) {
            return ['a', 'e', 'i', 'o', 'u'].includes(char.toLowerCase());
        }

        function getSuggestions(inputWord, dictionary) {
            var scores = {};

            dictionary.forEach(function (word) {
                var score = calculatePenaltyScore(inputWord, word);
                scores[word] = score;
            });
            var sortedSuggestions = Object.keys(scores).sort(function (a, b) {
                return scores[a] - scores[b];
            });
            return sortedSuggestions.slice(0, 10);
        }

        function loadDictionary(callback) {
            fetch('dictionary.txt')
                .then(response => response.text())
                .then(data => {
                    const dictionary = data.split('\n').map(word => word.trim().toLowerCase());
                    callback(dictionary);
                })
                .catch(error => console.error('Error loading dictionary:', error));
        }

        function checkSpell() {
            var wordInput = document.getElementById('word').value.toLowerCase();
            var suggestionBox = document.getElementById('suggestion-box');

            loadDictionary(function (dictionary) {
                var suggestions = getSuggestions(wordInput, dictionary);
                suggestionBox.innerHTML = suggestions.length > 0 ? suggestions.join(', ') : 'No suggestions found';
            });
        }

    </script>

</body>
</html>
