<?php
class ComparePairs {
    public function __invoke(array $a, array $b): bool {
        return $a['second'] < $b['second'];
    }
}

class SpellChecker {
    private array $dictionary = [];

    public function __construct() {
        $this->initializeDictionary();
    }

    public function checkSpelling($inputWord) {
        $suggestionScores = [];

        foreach ($this->dictionary as $dictWord) {
            $penalty = $this->calculatePenalty($inputWord, $dictWord);
            $suggestionScores[] = ['first' => $dictWord, 'second' => $penalty];
        }

        usort($suggestionScores, new ComparePairs());

        $numSuggestions = 10;
        for ($i = 0; $i < min($numSuggestions, count($suggestionScores)); $i++) {
            echo $suggestionScores[$i]['first'] . PHP_EOL;
        }
    }

    private function initializeDictionary() {
        $filename = "dictionary.txt";
        $fileContent = file_get_contents($filename);

        if ($fileContent === false) {
            echo "Could not open file $filename.";
        } else {
            $this->dictionary = explode("\n", $fileContent);
        }
    }

    private function calculatePenalty($word1, $word2) {
        $penalty = 0;

        for ($i = 0; $i < min(strlen($word1), strlen($word2)); ++$i) {
            if ($word1[$i] !== $word2[$i]) {
                if ($this->isVowel($word1[$i]) && $this->isVowel($word2[$i])) {
                    $penalty += 1;
                } elseif (!$this->isVowel($word1[$i]) && !$this->isVowel($word2[$i])) {
                    $penalty += 1;
                } else {
                    $penalty += 3;
                }
            }
        }

        $penalty += abs(strlen($word1) - strlen($word2)) * 2;

        return $penalty;
    }

    private function isVowel($c) {
        return $c == 'a' || $c == 'e' || $c == 'i' || $c == 'o' || $c == 'u';
    }
}

if ($_SERVER["REQUEST_METHOD"] === "POST") {
    $spellChecker = new SpellChecker();
    $inputWord = strtolower($_POST['word']);
    $spellChecker->checkSpelling($inputWord);
}
?>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spell Checker</title>
</head>

<body>
    <h1><b>Spell Checker</b></h1>

<form action="spell_checker.php" method="post">
    <label for="word">Enter Word:</label><br>
    <input type="text" id="word" name="word" required><br><br>
    <input type="submit" value="Check">
</form>

</html>
